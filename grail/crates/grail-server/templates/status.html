{% extends "layout.html" %}
{% block title %}Grail | Status{% endblock %}
{% block content %}
  <h2 style="margin:0 0 10px 0; font-weight:700;">Status</h2>
  <div class="grid">
    <div class="kv">
      <div class="k">SLACK_SIGNING_SECRET</div>
      <div class="v">
        {% if slack_signing_secret_set %}
          <span class="pill ok">set</span>
        {% else %}
          <span class="pill bad">missing</span>
        {% endif %}
      </div>
    </div>
    <div class="kv">
      <div class="k">SLACK_BOT_TOKEN</div>
      <div class="v">
        {% if slack_bot_token_set %}
          <span class="pill ok">set</span>
        {% else %}
          <span class="pill bad">missing</span>
        {% endif %}
      </div>
    </div>
    <div class="kv">
      <div class="k">TELEGRAM_BOT_TOKEN</div>
      <div class="v">
        {% if telegram_bot_token_set %}
          <span class="pill ok">set</span>
        {% else %}
          <span class="pill bad">missing</span>
        {% endif %}
      </div>
    </div>
    <div class="kv">
      <div class="k">TELEGRAM_WEBHOOK_SECRET</div>
      <div class="v">
        {% if telegram_webhook_secret_set %}
          <span class="pill ok">set</span>
        {% else %}
          <span class="pill bad">missing</span>
        {% endif %}
      </div>
    </div>
    <div class="kv">
      <div class="k">OPENAI_API_KEY</div>
      <div class="v">
        {% if openai_api_key_set %}
          <span class="pill ok">set</span>
        {% else %}
          <span class="pill bad">missing</span>
        {% endif %}
      </div>
    </div>
    <div class="kv">
      <div class="k">GRAIL_MASTER_KEY</div>
      <div class="v">
        {% if master_key_set %}
          <span class="pill ok">set</span>
        {% else %}
          <span class="pill bad">missing</span>
        {% endif %}
      </div>
    </div>
    <div class="kv">
      <div class="k">Queue Depth</div>
      <div class="v"><span class="pill">{{ queue_depth }}</span></div>
    </div>
    <div class="kv">
      <div class="k">Active Task</div>
      <div class="v">
        {% if active_task_id != "" %}
          <span class="pill">#{{ active_task_id }}</span>
        {% else %}
          <span class="pill">(none)</span>
        {% endif %}
      </div>
      {% if active_task_started_at != "" %}
        <div style="margin-top: 10px; color: var(--muted);">
          started_at={{ active_task_started_at }}
        </div>
      {% endif %}
    </div>
    <div class="kv">
      <div class="k">Pending Approvals</div>
      <div class="v"><span class="pill">{{ pending_approvals }}</span></div>
      <div style="margin-top: 10px; color: var(--muted);">
        Manage in <a href="/admin/approvals">Approvals</a>.
      </div>
    </div>
    <div class="kv">
      <div class="k">Permissions</div>
      <div class="v"><span class="pill">{{ permissions_mode }}</span></div>
    </div>
    <div class="kv">
      <div class="k">Worker Lock</div>
      <div class="v"><span class="pill">{{ worker_lock_owner }}</span></div>
    </div>
    <div class="kv">
      <div class="k">Guardrails Enabled</div>
      <div class="v"><span class="pill">{{ guardrails_enabled }}</span></div>
      <div style="margin-top: 10px; color: var(--muted);">
        Manage in <a href="/admin/guardrails">Guardrails</a>.
      </div>
    </div>
  </div>

  <p style="margin:16px 0 0 0; color: var(--muted);">
    Slack events: <span class="pill">POST {{ slack_events_url }}</span>
  </p>
  <p style="margin:10px 0 0 0; color: var(--muted);">
    Slack interactivity: <span class="pill">POST {{ slack_actions_url }}</span>
  </p>
  <p style="margin:10px 0 0 0; color: var(--muted);">
    Telegram webhook: <span class="pill">POST {{ telegram_webhook_url }}</span>
  </p>
{% endblock %}
